### 第2章 一面上半场——项目业务架构介绍



#### 如何做自我介绍

第一印象的关键，掌握主动权的机会

##### 要点

- 简短有力 3-4分钟较好
- 内容要有结构性：经历简介、项目经历、技术总结
- 凸显能力：技术经验能力（技术栈、学到的技术使用在什么场景）、学习思考能力



##### 介绍前的思考

- 你的一面面试官和你未来工作的关系
- 他想要从我的自我介绍中了解什么



##### 介绍的内容

- ###### 经历简介

  个人信息，教育背景，职业生涯，工作年限

- ###### 项目经历

  电商项目：微服务，领域模型驱动设计，结果产出，qps，高并发场景，担当什么？

- ###### 技能总结

  你的技术栈，开发语言，主要框架，中间件（存储，微服务相关，大数据，部署相关），业余时间学习or最近在学什么



##### 介绍的亮点

- 谦逊：能力再强也需要和谐的研发环境
- 自信：代表了你对个人价值的认可
- 与众不同：深度思考，愿意学习探索



#### 提问环节

- ##### 介绍下你做的项目

- ##### 你项目的业务场景，系统架构，工作职责分别是什么样的

- ##### 你的项目中有哪些亮点，你是如何处理和解决这些难点问题的

  **抛出问题回答问题**

  ###### 什么样的问题是难解决的（主要是想看下你做的内容的深度实操经验以及拟解决问题的思考和手段）

  - 常见问题or偏门问题
  - 正常问题or踩坑问题



#### 聊聊项目

##### 既然你主要做的是电商方向，详细聊聊你做的电商项目吧？

###### 要点

- 项目场景介绍
- 系统架构方案
- 你负责了哪块



#### 你有什么要问的吗





#### 系统架构方案



##### 分维度介绍

- ###### 系统架构：体现整体部署架构，选型思考

1. 流量入口
2. 服务治理
3. 数据选型

- ###### 业务架构：业务场景引入进来做业务架构设计



#### 交易一致性问题

##### 重复支付(支付系统通知订单系统重复通知情况)

###### 重复支付问题解决

- 伪防重操作（并发操作下不能防止）

  ```
  begin transaction
  select * from order_info where ord_id = '2021'
  2.if pay_sts == D  执行3 否则直接返回
  3.update order_info set status = C where id = '2021'
  4.判断影响行数为1，发货
  commit
  ```

  

- 悲观锁（防重幂等操作）

```
begin transaction
select * from order_info where ord_id = '2021' for update （加 record lock）
2.if pay_sts == D  执行3 否则直接返回
3.update order_info set status = C where id = '2021'
4.判断影响行数为1，发货
commit
```



- 乐观锁（防重幂等操作）（优等方案）

```
begin transaction
select * from order_info where ord_id = '2021'
2.if pay_sts == D  执行3 否则直接返回
3.update order_info set status = C where id = '2021' and status = D
4.判断影响行数为1，发货
commit
```



##### 超时退问题（考察点：分布式事务、流水号应用、重试方式）

- ###### 如何回滚内容

- ###### 回滚失败如何解决

- ###### 重复回滚如何预防



#### 分布式原理

CAP

一致性（Consistency）:客户端知道一系列的操作都会同时发生（生效）

可用性（Availability）：每个操作都必须以可预期的响应结束

分区容错性(Partition tolerance)：即使出现单个组件无法可用，操作依然可以完成



##### Base原理（保护A 牺牲C）

Basically Available(基本可用)

Soft state（软状态 ）

Eventually consistent（最终一致性）
